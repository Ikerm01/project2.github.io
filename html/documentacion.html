<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Techsys Solutions</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../css/style.css">
    <script src="../js/menu.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
</head>

<body>
    <header class="header">
        <div class="nav-container">
            <div class="logo">
                <img src="../imagenes/logo_white.png" alt="Logo">
            </div>
            <button id="menu-toggle" class="menu-btn">
                <i class="bi bi-list"></i>
            </button>
            <nav id="nav-menu" class="hidden">
                <ul class="nav-links">
                    <li><a href="/project2.github.io/index.html">Inicio</a></li>
                    <li><a href="explicacion.html">Explicación</a></li>
                    <li><a href="documentacion.html">Documentación</a></li>
                    <li><a href="contacto.html">Contacto</a></li>
                </ul>
            </nav>
        </div>
        <h1>Documentacion</h1>
        <h3>Documentacion sobre Proxmox y su funcionamiento</h3>
    </header><br>
    <aside class="sidebar">
        <h2>Menú</h2>
        <ul>
            <li><a href="#documentación-de-proxmox">1.Introducción</a></li>
            <li><a href="#2-ventajas-y-desventajas">2.Ventajas y Desventajas</a></li>
            <li><a href="#3-funcionamiento">3.Funcionamiento</a></li>
            <li><a href="#pfsense">PFSense</a></li>
            <li><a href="#proxmox-ve">Proxmox VE</a></li>
            <li><a href="#proxmox-bs">Proxmox BS</a></li>
            <li><a href="#4-documentaci-n-del-bot-de-telegram-con-google-apps-script">4.Documentacion del Bot de
                    Telegram</a></li>
            <li><a href="#-l-gica-del-bot-apps-script-">Lógica del Bot (Apps Script)</li>
            <li><a href="#guacamole">Guacamole</a></li>
            <li><a href="#vpn">VPN</a></li>
            <li><a href="#5-hardware-compatible">5.Hardware Compatible</a></li>
            <li><a href="#6-webgrafía">6.Webgrafía</a></li>
        </ul>
    </aside>
    <div class="informacion2">
        <h3 id="1-introducción">1. Introducción</h3>
        <p>En esta sección, se abordará el funcionamiento de herramientas como <strong>PFSense</strong>, así como el
            hardware necesario para implementar <strong>Proxmox VE</strong>. También se incluirán ilustraciones
            detalladas sobre el proceso de instalación, sus características más relevantes y referencias de sitios
            web consultados.</p><br>

        <h3 id="2-ventajas-y-desventajas">2. Ventajas y Desventajas</h3>
        <table>
            <thead>
                <tr>
                    <th><strong>Ventajas</strong></th>
                    <th><strong>Desventajas</strong></th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Aumenta la productividad, eficacia, agilidad y capacidad de respuesta del departamento de
                        TI.
                    </td>
                    <td>Para empresas pequeñas, puede ser difícil pensar en una sala de equipos o servidores. No
                        obstante, existen soluciones adecuadas para iniciarse en este ámbito.</td>
                </tr>
                <tr>
                    <td>Facilita y simplifica el despliegue de recursos y aplicaciones. Reduce o elimina los tiempos
                        de
                        inactividad.</td>
                    <td>Dentro de las máquinas virtuales, es crucial no sobrecargar un servidor con demasiadas
                        instancias. Es importante considerar las características del hardware físico para obtener un
                        rendimiento óptimo.</td>
                </tr>
                <tr>
                    <td>Proxmox reduce los costes fijos y los gastos operativos.</td>
                    <td>Aunque cuenta con una interfaz web intuitiva, requiere conocimientos avanzados de
                        <strong>Linux</strong> y <strong>virtualización</strong> para configuraciones complejas.
                    </td>
                </tr>
            </tbody>
        </table><br>

        <h3 id="3-funcionamiento">3. Funcionamiento</h3>
        <h4 id="pfsense">PFSense</h4>
        <p>PFSense es un <strong>firewall</strong> y <strong>router</strong> de código abierto basado en FreeBSD,
            ampliamente utilizado para la gestión de redes en entornos virtualizados. Su integración con Proxmox
            permite:</p>
        <img src="../imagenes/PfSlogo.png" alt="Pfsense" width="200" height="75">
        <ul>
            <li><strong>Implementación de firewalls</strong> avanzados dentro de máquinas virtuales.</li>
            <li><strong>Gestión del tráfico</strong> de red en entornos corporativos.</li>
            <li><strong>Creación de VPNs</strong> seguras para accesos remotos.</li>
            <li><strong>Control de ancho</strong> de banda y filtrado de contenido.</li><br>
        </ul>
        <h4 id="instalaci-n-de-pfsense">Instalación de PFSense</h4>
        <ol>
            <li><strong>Descargar pfSense</strong>: Ve a la página oficial de pfSense y descarga el archivo ISO para tu
                arquitectura (usualmente <code>amd64</code>).</li>
            <li><strong>Crear medio de instalación</strong>: Usa herramientas como <strong>Rufus</strong> para grabar la
                ISO en un USB o CD/DVD.</li>
            <li><strong>Arrancar desde el medio de instalación</strong>: Conecta el USB o CD al equipo, arranca desde él
                y sigue las instrucciones de instalación. </li>
            <li><strong>Instalar pfSense</strong>: Selecciona el disco donde deseas instalar pfSense y confirma la
                instalación. Reinicia cuando termine.</li>
            <li><strong>Configurar pfSense</strong>: Conecta una computadora a la interfaz LAN, ingresa a
                <strong>192.168.1.1</strong> desde un navegador y usa el usuario <strong>admin</strong> y la contraseña
                <strong>pfsense</strong>.
            </li>
            <li><strong>Configuración inicial</strong>: Sigue el asistente para configurar las interfaces de red y
                ajustes básicos como IP, DNS y zona horaria.</li>
        </ol>
        <h4 id="configuraci-n">Configuración</h4>
        <p><strong>Configurar WAN</strong></p>
        <ol>
            <li>Accede a <strong>Interfaces</strong> &gt; <strong>WAN</strong>.</li>
            <li>Si tu ISP da <strong>IP dinámica</strong>, selecciona <strong>DHCP</strong>. Si es
                <strong>estática</strong>, selecciona <strong>Static IP</strong> y configura la IP proporcionada.
            </li>
            <li>Guarda los cambios.</li>
            <img src="../imagenes/1wan.png" alt="WAN" width="750" height="450">
            <img src="../imagenes/2wan.png" alt="WAN" width="750" height="450">
        </ol>
        <p><strong>Configurar LAN</strong></p>
        <ol>
            <li>Accede a <strong>Interfaces</strong> &gt; <strong>LAN</strong>.</li>
            <li>Asigna una <strong>IP estática</strong> para la LAN (ej. <code>192.168.1.1</code>). </li>
            <li>Habilita la interfaz LAN y guarda los cambios.</li>
            <img src="../imagenes/1lan.png" alt="LAN" width="750" height="450">
            <img src="../imagenes/2lan.png" alt="LAN" width="750" height="450">
        </ol>
        <p><strong>Configurar el Servidor DHCP</strong></p>
        <ol>
            <li>Ve a <strong>Services</strong> &gt; <strong>DHCP Server</strong>.</li>
            <li>Habilita el servidor DHCP para la interfaz <strong>LAN</strong>.</li>
            <li>Define un <strong>rango de IPs</strong> (ej. <code>192.168.1.100</code> a <code>192.168.1.200</code>).
            </li>
            <li>Guarda los cambios.</li>
            <img src="../imagenes/1dhcp.png" alt="DHCP" width="750" height="450">
            <img src="../imagenes/2dhcp.png" alt="DHCP" width="750" height="450">
            <img src="../imagenes/3dhcp.png" alt="DHCP" width="750" height="450">
            <img src="../imagenes/4dhcp.png" alt="DHCP" width="750" height="450">
        </ol>
        <p><strong>Configurar el Firewall</strong></p>
        <ol>
            <li>Ve a <strong>Firewall</strong> &gt; <strong>Rules</strong>. </li>
            <li>En la interfaz <strong>LAN</strong>, agrega una regla para permitir tráfico de LAN a WAN (acción:
                <strong>Pass</strong>).
            </li>
            <li>En la interfaz <strong>WAN</strong>, generalmente no se necesitan reglas adicionales. <ul>
                    <li>Aplica los cambios.</li>
                    <img src="../imagenes/1fw.png" alt="FireWall" width="750" height="450">
                    <img src="../imagenes/2fw.png" alt="FireWall" width="750" height="450">
                    <img src="../imagenes/3fw.png" alt="FireWall" width="750" height="450">
                    <img src="../imagenes/4fw.png" alt="FireWall" width="750" height="450">
                </ul>
            </li>
        </ol>
        <p><strong>Verificar</strong></p>
        <ol>
            <li>Conecta un dispositivo a la LAN y verifica que obtenga una IP del rango DHCP y pueda acceder a Internet.
            </li>
        </ol>

        <h4 id="proxmox-ve">Proxmox VE</h3>
            <p>Proxmox VE es una plataforma de <strong>virtualización de código abierto</strong>, que combina
                <strong>KVM</strong> y <strong>LXC</strong> para ofrecer una solución integral de administración
                de máquinas virtuales y contenedores. Entre sus funcionalidades destacan:
            </p>
            <ul>
                <li><strong>Gestión centralizada</strong> mediante clústeres de Proxmox.</li>
                <li><strong>Snapshots y backups</strong> eficientes.</li>
                <li><strong>Alta disponibilidad (HA)</strong> para entornos críticos.</li>
                <li><strong>Ceph y ZFS</strong> como opciones avanzadas de almacenamiento distribuido.</li><br>
            </ul>
            <p>La instalación de Proxmox VE es un proceso relativamente sencillo. Se deben seguir los siguientes
                pasos:</p>
            <ol>
                <li>Descargar la ISO de <strong>Proxmox VE</strong> desde el <a
                        href="https://www.proxmox.com/en/downloads">sitio oficial</a>.</li>
                <li>Crear un medio de instalación (USB o DVD) y configurar el BIOS para arrancar desde él.</li>
                <li>Seguir las instrucciones del asistente de instalación.</li>
                <li>Configurar la red y la interfaz web de administración.</li>
                <li>Realizar actualizaciones y ajustes según las necesidades del sistema.</li>
            </ol>

            <h4 id="proxmox-bs">Proxmox BS</h4>
            <p>Proxmox BS es una solución de respaldo empresarial diseñada, para <strong>máquinas virtuales,
                    contenedores y hosts físicos.</strong> Ofrece
                copias de seguridad incrementales y deduplicadas, lo que reduce la carga de red y el espacio de
                almacenamiento. Gracias a sus potentes
                <strong>métodos de cifrado e integridad,</strong> garantiza la seguriada de los datos incluso en
                destinos no confiables. Entre sus funcionalidades destacan:
            </p>
            <p>Debido al presupuesto, nuestro PBS se encuentra dentro de PVE, pero en el futuro tendremos un
                servidor
                dedicado para PBS.
            </p>
            <ul>
            </ul>
            <h4 id="ventajas">Ventajas</h4>
            <ul>
                <li><strong>Backups incrementales,</strong> que solo guardan los cambios desde la última copia.
                </li>
                <li><strong>Deduplicación de datos,</strong> que evita almacenar información duplciada.</li>
                <li><strong>Compresión,</strong> que reduce el espacio encesario para los backups.</li>
            </ul>
            <h4 id="instalaci-n-de-proxmox-bs">Instalación de Proxmox BS</h4>
            <ol>
                <li><strong>Descargar la ISO</strong>: Obtenga la iamgen ISO de Proxmox Backup Server y cópiela
                    en una
                    unidad USB o CD/DVD. <a
                        href="https://www.proxmox.com/en/downloads/proxmox-backup-server/iso">Descargar
                        aquí</a>.</li>
                <li><strong>Arrancar desde USB</strong>: Inicie el sistema desde la unidad USB y pulse
                    &quot;Intro&quot;
                    para comenzar la instalación. </li>
                <li><strong>Configuración via web</strong>: Administre todo desde su navegador sin necesidad de
                    herramientas
                    adicionales.</li>
            </ol>
            <h4 id="configuraci-n-de-backup-encriptado">Configuración de Backup Encriptado</h4>
            <img src="../imagenes/1.png" alt="Encriptado" width="750" height="450">
            <img src="../imagenes/2.png" alt="Encriptado" width="750" height="450">
            <img src="../imagenes/3.png" alt="Encriptado" width="750" height="450">
            <img src="../imagenes/4.png" alt="Encriptado" width="750" height="450">
            <br>

            <h2 id="4-documentaci-n-del-bot-de-telegram-con-google-apps-script">4. Documentación del Bot de Telegram con
                Google Apps Script</h2>
            <h4 id="-descripci-n-general">Descripción General</h4>
            <p>Este bot de Telegram, llamado Marcos, está diseñado para asistir a los usuarios con consultas comunes y
                para derivar solicitudes de contacto a un equipo humano. Las respuestas se registran automáticamente en
                una hoja de cálculo de Google Sheets para su seguimiento. Además, se envía un correo cuando se solicita
                asistencia.</p>
            <h4 id="-tecnolog-as-utilizadas">Tecnologías Utilizadas</h4>
            <ul>
                <li>Telegram Bot API (creado con BotFather) </li>
                <li>Google Apps Script </li>
                <li>Google Sheets </li>
                <li>MailApp (Gmail) </li>
            </ul>
            <h4 id="-url-del-script-webhook-">URL del Script (Webhook)</h4>
            <p>plaintext</p>
            <p>CopiarEditar</p>
            <p>
                <a
                    href="https://script.google.com/macros/s/AKfycbyFBJYvbOJlyX4cIKRT6GTibbACInMn99PhaD4qItVrEoQncXVRZKCIAFOQJeA19_N3/exec">https://script.google.com/macros/s/AKfycbyFBJYvbOJlyX4cIKRT6GTibbACInMn99PhaD4qItVrEoQncXVRZKCIAFOQJeA19_N3/exec</a>
            </p>
            <h4 id="-comandos-disponibles">Comandos Disponibles</h4>
            <table>
                <thead>
                    <tr>
                        <th>Comando</th>
                        <th>Descripción</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>/start</td>
                        <td>Muestra el mensaje de bienvenida y el menú de opciones</td>
                    </tr>
                    <tr>
                        <td>/contacto</td>
                        <td>Solicita ayuda de un asistente y genera un correo automático</td>
                    </tr>
                    <tr>
                        <td>/faq</td>
                        <td>Muestra preguntas frecuentes y sus respuestas</td>
                    </tr>
                    <tr>
                        <td>/exit</td>
                        <td>Finaliza la conversación</td>
                    </tr>
                    <tr>
                        <td>Otro</td>
                        <td>Devuelve un mensaje de error si el comando no está reconocido</td>
                    </tr>
                </tbody>
            </table>
            <h3 id="-l-gica-del-bot-apps-script-">Lógica del Bot (Apps Script)</h3>
            <h4 id="1-inicializaci-n">1. Inicialización</h4>
            <ul>
                <li>Se define el token del bot y la URL del webhook. </li>
                <li>Se establece un diccionario de comandos (command) con las respuestas automáticas. </li>
            </ul>
            <h4 id="2-webhook-setup">2. Webhook Setup</h4>
            <p>js
                CopiarEditar
                <code>function setWebhook(){
                var url = apiUrl + &quot;/setwebhook?url=&quot;+appUrl;
                UrlFetchApp.fetch(url).getContentText();
                }</code>
            </p>
            <h4 id="3-manejo-de-mensajes-post-">3. Manejo de Mensajes (POST)</h4>
            <p>Cuando un usuario escribe en el bot:</p>
            <ul>
                <li>Se extrae el userID, nombre, mensaje y fecha. </li>
                <li>Se registra el mensaje en un Google Sheet. </li>
                <li>Si el usuario escribe /contacto, se dispara una función para enviar un correo. </li>
                <li>Se genera la respuesta automática en función del comando recibido. </li>
            </ul>
            <p>js
                CopiarEditar</p>
            <p><code>function doPost(e) {
            var webhookData = JSON.parse(e.postData.contents);
            ...
            sheet.appendRow([from, username, text, date]);
            if (text === &quot;/contacto&quot;) {
            sendEmail();
            }
            ...
            UrlFetchApp.fetch(url, opts).getContentText();
            }</code></p>
            <h4 id="4-guardar-en-google-sheets">4. Guardar en Google Sheets</h4>
            <p>Los mensajes se guardan en la hoja:
                less</p>
            <p>CopiarEditar </p>
            <ul>
                <li>ID del Usuario </li>
                <li>Nombre </li>
                <li>Mensaje </li>
                <li>Fecha </li>
            </ul>
            <h4 id="5-correo-autom-tico">5. Correo Automático</h4>
            <p>Se envía un correo cuando un usuario escribe /contacto:
                js</p>
            <p>CopiarEditar</p>
            <p><code>function sendEmail() {
            var email = &quot;ilozano@institutmvm.cat&quot;;
            var subject = &quot;Solicitud de contacto desde el bot de Telegram&quot;;
            var body = &quot;Una persona ha solicitado ayuda a través del bot de Telegram.&quot;;
            MailApp.sendEmail(email, subject, body);
            }</code></p>
            <h2 id="-despliegue-y-pruebas">Despliegue y Pruebas</h2>
            <ol>
                <li>Ir a Deploy &gt; Manage deployments en el entorno de Google Apps Script. </li>
                <li>Crear un nuevo despliegue tipo Web app.
                    <pre><code>  -<span class="ruby">    Ejecutar <span class="hljs-symbol">como:</span> Yo 
            </span>  -<span class="ruby">    Quién tiene <span class="hljs-symbol">acceso:</span> Cualquiera, incluso anónimo  </span>
            </code></pre>
                </li>
                <li>Copiar la URL generada y establecerla como webhook con la función setWebhook(). </li>
                <li>Probar el bot enviando /start desde Telegram. </li>
            </ol>
            <h2 id="-seguridad">Seguridad</h2>
            <ul>
                <li>Solo se responde a comandos conocidos. </li>
                <li>Se limita el método GET para evitar accesos no deseados:<br>js</li>
            </ul>
            <p>CopiarEditar
                <code>function doGet(e){
return ContentService.createTextOutput(&quot;Método GET no permitido&quot;);
}</code>
            </p>
            <h3 id="guacamole">Guacamole</h3>
            <p>Un resumen rápido: este script automatiza la instalación de Guacamole Server (guacd), la configuración de
                Apache Tomcat 9, la implementación del cliente web (WAR) y la autenticación JDBC con MariaDB/MySQL,
                creando además los servicios systemd necesarios y limpiando los archivos temporales al finalizar.
                Contenido</p>
            <pre><code><span class="hljs-number">1.</span> Requisitos previos
                
                <span class="hljs-number">2.</span> Obtención y ejecución del script
                
                <span class="hljs-number">3.</span> Desglose paso a paso
                
                    <span class="hljs-number">3.1</span> Instalación de dependencias
                
                    <span class="hljs-number">3.2</span> Configuración de Apache Tomcat <span class="hljs-number">9</span>
                
                    <span class="hljs-number">3.3</span> Compilación e instalación de Guacamole Server
                
                    <span class="hljs-number">3.4</span> Despliegue del cliente web
                
                    <span class="hljs-number">3.5</span> Configuración de autenticación JDBC
                
                    <span class="hljs-number">3.6</span> Servicios systemd
                
                <span class="hljs-number">4.</span> Post-instalación y personalización
                
                <span class="hljs-number">5.</span> Limpieza final
                
                <span class="hljs-number">6.</span> Referencias
                </code></pre>
            <ol>
                <li>
                    <p>Requisitos previos</p>
                    <p> Proxmox VE 8.x (o superior) en un contenedor LXC o VM Debian/Ubuntu.
                        community-scripts.github.io</p>
                    <p> Acceso root o usuario con sudo sin contraseña.
                        community-scripts.github.io</p>
                    <p> Conectividad a Internet para descargar paquetes y código fuente.</p>
                </li>
                <li>
                    <p>Obtención y ejecución del script</p>
                </li>
            </ol>
            <p>Descarga y ejecuta el instalador directamente desde GitHub:</p>
            <p>curl -fsSL <a
                    href="https://raw.githubusercontent.com/community-scripts/ProxmoxVE/main/install/apache-guacamole-install.sh">https://raw.githubusercontent.com/community-scripts/ProxmoxVE/main/install/apache-guacamole-install.sh</a>
                | bash</p>
            <p>Este comando lee y ejecuta el script ubicado en el repositorio oficial de Proxmox VE Helper-Scripts
                community-scripts.github.io
                .</p>
            <pre><code><span class="hljs-built_in">T</span><span class="hljs-symbol">ip:</span> Para mayor control, clona el repositorio, ajusta variables (versió<span class="hljs-built_in">n</span> de Guacamole, rutas), y ejecútalo localmente.
                </code></pre>
            <ol>
                <li>Desglose paso a paso
                    3.1 Instalación de dependencias</li>
            </ol>
            <p>Se instalan todos los paquetes necesarios para compilar guacamole-server y soportar RDP/VNC/SSH:</p>
            <p>apt-get update
                apt-get install -y build-essential libcairo2-dev libpng-dev \
                libossp-uuid-dev libvncserver-dev freerdp2-dev libssh2-1-dev \
                libtelnet-dev libwebsockets-dev libpulse-dev libvorbis-dev \
                libwebp-dev libssl-dev libpango1.0-dev libswscale-dev \
                libavcodec-dev libavutil-dev libavformat-dev \
                default-jdk mariadb-server</p>
            <p>Estas mismas librerías se mencionan en la documentación oficial de Guacamole .</p>
            <p>3.2 Configuración de Apache Tomcat 9</p>
            <pre><code>Descarga automática <span class="hljs-keyword">de</span> <span class="hljs-keyword">la</span> última Tomcat 9 desde mirrors <span class="hljs-keyword">de</span> Apache.

Extracció<span class="hljs-keyword">n</span> <span class="hljs-keyword">en</span> /opt/apache-guacamole/tomcat9 y creació<span class="hljs-keyword">n</span> del usuario <span class="hljs-keyword">de</span> sistema tomcat.

Ajuste <span class="hljs-keyword">de</span> permisos <span class="hljs-keyword">en</span> <span class="hljs-keyword">conf</span>/ para asegurar <span class="hljs-keyword">que</span> sólo root y tomcat puedan leer <span class="hljs-keyword">la</span> configuració<span class="hljs-keyword">n</span>.
</code></pre>
            <p>3.3 Compilación e instalación de Guacamole Server</p>
            <pre><code>Obtiene <span class="hljs-keyword">el</span> último <span class="hljs-keyword">tag</span> de apache/guacamole-server.

Compila <span class="hljs-keyword">e</span> instala <span class="hljs-keyword">con</span>:

<span class="hljs-keyword">cd</span> guacamole-server-&lt;versión&gt;
autoreconf -fi
./configure --with-init-dir=/etc/init.d --enable-allow-freerdp-snapshots
<span class="hljs-keyword">make</span> &amp;&amp; <span class="hljs-keyword">make</span> install &amp;&amp; ldconfig

Esto crea guacd, <span class="hljs-keyword">el</span> demonio de multiplexación de conexiones RDP/VNC/SSH .
</code></pre>
            <p>3.4 Despliegue del cliente web</p>
            <pre><code>Descarga <span class="hljs-selector-tag">del</span> guacamole-&lt;versión&gt;<span class="hljs-selector-class">.war</span> desde los mirrors de Apache.

Copia <span class="hljs-selector-tag">a</span> /opt/apache-guacamole/tomcat9/webapps/guacamole<span class="hljs-selector-class">.war</span>.

Acceso al cliente en http:<span class="hljs-comment">//&lt;IP-del-nodo&gt;:8080/guacamole.</span>
</code></pre>
            <p>3.5 Configuración de autenticación JDBC</p>
            <pre><code>Descarga <span class="hljs-keyword">de</span> MySQL Connector/J y Guacamole JDBC <span class="hljs-keyword">plugin</span>.

Ubicació<span class="hljs-keyword">n</span> <span class="hljs-keyword">de</span> los JAR <span class="hljs-keyword">en</span> /etc/guacamole/lib/ y /etc/guacamole/extensions/.

Creació<span class="hljs-keyword">n</span> <span class="hljs-keyword">de</span> <span class="hljs-keyword">la</span> base <span class="hljs-keyword">de</span> datos y usuario <span class="hljs-keyword">en</span> MariaDB/MySQL:

CREATE DATABASE guacamole_db;
CREATE USER 'guacamole_user'@'localhost' IDENTIFIED <span class="hljs-keyword">BY</span> '&lt;contraseña_aleatoria&gt;';
GRANT ALL PRIVILEGES <span class="hljs-keyword">ON</span> guacamole_db.* TO 'guacamole_user'@'localhost';
FLUSH PRIVILEGES;

Importació<span class="hljs-keyword">n</span> del esquema SQL (*.sql) <span class="hljs-keyword">en</span> guacamole_db.

Generació<span class="hljs-keyword">n</span> <span class="hljs-keyword">de</span> /etc/guacamole/guacamole.properties con los parámetros <span class="hljs-keyword">de</span> conexió<span class="hljs-keyword">n</span>.
</code></pre>
            <p>3.6 Servicios systemd</p>
            <p>Se crean y habilitan dos unidades:</p>
            <pre><code>guacd<span class="hljs-selector-class">.service</span> que gestiona el demonio guacd.

tomcat<span class="hljs-selector-class">.service</span> para arrancar Tomcat con CATALINA_HOME=/opt/apache-guacamole/tomcat9.
</code></pre>
            <p>Ambos servicios, junto a MariaDB, se inician automáticamente al arranque .</p>
            <ol>
                <li>
                    <p>Post-instalación y personalización</p>
                    <p> Credenciales: revisa el fichero ~/guacamole.creds para usuario, contraseña y DB.</p>
                    <p> Firewall: abre los puertos 4822 (guacd) y 8080 (Tomcat).
                        GitHub</p>
                    <p> HTTPS: en producción, usa un proxy inverso (nginx/Traefik) con certificado TLS.
                        community-scripts.github.io</p>
                    <p> Backups: respalda /etc/guacamole/ y la base de datos periódicamente.</p>
                </li>
                <li>
                    <p>Limpieza final</p>
                </li>
            </ol>
            <p>El script elimina archivos temporales (*.tar.gz, carpetas de compilación) y ejecuta apt autoremove y apt
                autoclean para liberar espacio .</p>
            <ol>
                <li>
                    <p>Referencias</p>
                    <p> Script apache-guacamole-install.sh – Proxmox VE Helper-Scripts (Community)
                        community-scripts.github.io</p>
                    <p> Proxmox VE Helper-Scripts – Página oficial de la comunidad de scripts.
                        community-scripts.github.io</p>
                    <p> Guacamole Installing Guide – Documentación oficial Apache Guacamole.</p>
                    <p> Issue: guacd sólo escucha IPv6 – Detalle de puerto y binding en el script.
                        GitHub</p>
                    <p> Cambio en guacd service – Corrección de inicio en release 2024-12-31.</p>
                </li>
            </ol>

            <h3 id="vpn">VPN</h3>
            <h4 id="-requisitos">Requisitos</h4>
            <ul>
                <li>
                    <p>Una instalación funcional de pfSense (v2.4 o superior recomendado)</p>
                </li>
                <li>
                    <p>Acceso administrativo a pfSense</p>
                </li>
                <li>
                    <p>Un cliente VPN compatible (OpenVPN Client para Windows, macOS, Linux, Android, etc.)</p>
                </li>
            </ul>
            <hr>
            <h4 id="-paso-1-instalar-el-paquete-de-openvpn">Paso 1: Instalar el paquete de OpenVPN</h4>
            <ol>
                <li>
                    <p>Ir a <code>System &gt; Package Manager &gt; Available Packages</code>.</p>
                </li>
                <li>
                    <p>Buscar <code>openvpn-client-export</code>.</p>
                </li>
                <li>
                    <p>Instalar el paquete.</p>
                </li>
            </ol>
            <p><img src="https://lh7-rt.googleusercontent.com/docsz/AD_4nXefI-IBbq9YwypghvtqZ7XbjeX3tjs_kBgCUCZPD5P5hyL38sKhUjIDxdm0Kc-N5r3D7YTE2877wt-GweUPMQ4Uv5l9OKemg2AIYRQ3PM0Y_rTalNsjeLbwYQSlmAiTQ6tXKhqU?key=_YQlVURTdgHza7i-ocS-hCXB"
                    alt=""></p>
            <hr>
            <h4 id="-paso-2-crear-una-autoridad-certificadora-ca-">Paso 2: Crear una Autoridad Certificadora (CA)
            </h4>
            <ol>
                <li>
                    <p>Ir a <code>System &gt; Cert. Manager &gt; CAs</code>.</p>
                </li>
                <li>
                    <p>Click en <code>Add</code>.</p>
                </li>
                <li>
                    <p>Llenar los campos:</p>
                </li>
                <li>
                    <p><strong>Descriptive Name:</strong> <code>VPN_CA</code></p>
                </li>
                <li>
                    <p><strong>Method:</strong> Create an internal Certificate Authority</p>
                </li>
                <li>
                    <p>Rellenar los campos de país, estado, ciudad, etc.</p>
                </li>
                <li>
                    <p>Guardar.</p>
                </li>
            </ol>
            <hr>
            <p><img src="https://lh7-rt.googleusercontent.com/docsz/AD_4nXd8cbMTbx3ja2U-JxPsaFtc3Vi4qWQ1_B3T3A5ScCTsA3Op9awhTySMbOf9ejKWnH5360vj50ujeQe8iIN4n5vHNLW6ESLzbSK2zWhzvHS8ORilgBsZj7SCcq2oIvuEt0KSOp5XPw?key=_YQlVURTdgHza7i-ocS-hCXB"
                    alt=""></p>
            <h4 id="-paso-3-crear-el-certificado-del-servidor">Paso 3: Crear el Certificado del Servidor</h4>
            <ol>
                <li>
                    <p>Ir a <code>System &gt; Cert. Manager &gt; Certificates</code>.</p>
                </li>
                <li>
                    <p>Click en <code>Add/Sign</code>.</p>
                </li>
                <li>
                    <p>Llenar los campos:</p>
                </li>
                <li>
                    <p><strong>Method:</strong> Create an internal certificate</p>
                </li>
                <li>
                    <p><strong>Descriptive Name:</strong> <code>OpenVPN_Server</code></p>
                </li>
                <li>
                    <p><strong>Certificate Type:</strong> Server Certificate</p>
                </li>
                <li>
                    <p>Seleccionar la CA creada anteriormente</p>
                </li>
                <li>
                    <p>Rellenar los datos requeridos</p>
                </li>
                <li>
                    <p>Guardar.</p>
                </li>
            </ol>
            <p><img src="https://lh7-rt.googleusercontent.com/docsz/AD_4nXcYIr6d8_ORN79nfRmXzzGUCqHOusni7zGTIYg8WTznb8J84Z1CmP835H42MwDd38jHm1XzqJOxxslEUY-J5BhRlzxP8ymJmpeCA3DH88Grw66eA00iSrtKKsb3EO3gENyZmMGJ-w?key=_YQlVURTdgHza7i-ocS-hCXB"
                    alt=""></p>
            <hr>
            <h4 id="-paso-4-crear-el-servidor-openvpn">Paso 4: Crear el Servidor OpenVPN</h4>
            <ol>
                <li>
                    <p>Ir a <code>VPN &gt; OpenVPN &gt; Servers</code>.</p>
                </li>
                <li>
                    <p>Click en <code>Add</code>.</p>
                </li>
                <li>
                    <p>Configurar los parámetros:</p>
                </li>
                <li>
                    <p><strong>Server Mode:</strong> Remote Access (SSL/TLS)</p>
                </li>
                <li>
                    <p><strong>Backend for authentication:</strong> Local Database</p>
                </li>
                <li>
                    <p><strong>Protocol:</strong> UDP</p>
                </li>
                <li>
                    <p><strong>Interface:</strong> WAN</p>
                </li>
                <li>
                    <p><strong>Local Port:</strong> 1194</p>
                </li>
                <li>
                    <p><strong>TLS Authentication:</strong> Enable</p>
                </li>
                <li>
                    <p><strong>Peer Certificate Authority:</strong> VPN_CA</p>
                </li>
                <li>
                    <p><strong>Server Certificate:</strong> OpenVPN_Server</p>
                </li>
                <li>
                    <p><strong>Encryption Algorithm:</strong> AES-256-CBC</p>
                </li>
                <li>
                    <p><strong>Auth Digest Algorithm:</strong> SHA256</p>
                </li>
                <li>
                    <p><strong>Tunnel Network:</strong> <a href="http://10.8.0.0/24">10.8.0.0/24</a></p>
                </li>
                <li>
                    <p><strong>Local Network:</strong> (<a href="http://192.168.1.0/24">192.168.1.0/24</a>)</p>
                </li>
                <li>
                    <p>Guardar y aplicar los cambios.</p>
                </li>
            </ol>
            <hr>
            <p><img src="https://lh7-rt.googleusercontent.com/docsz/AD_4nXf-G9xeVYxQv9R69Hnp5P3eSzdOLRx_zr5R2zavUxhsj7ChiQQUi-vVI98g2TB8bEucyfBiFy8ioFri-hl2VOS2yEbKFN9BEnoS4f9gxtvo-MsKy3nlTUvO0G4szX1_-OgVSIf6Pw?key=_YQlVURTdgHza7i-ocS-hCXB"
                    alt=""></p>
            <h4 id="-paso-5-crear-usuarios-y-certificados">Paso 5: Crear Usuarios y Certificados</h4>
            <ol>
                <li>
                    <p>Ir a <code>System &gt; User Manager &gt; Users</code>.</p>
                </li>
                <li>
                    <p>Click en <code>Add</code>.</p>
                </li>
                <li>
                    <p>Crear un nuevo usuario y marcar la opción <code>Click to create a user certificate</code>.</p>
                </li>
                <li>
                    <p>Seleccionar la CA <code>VPN_CA</code> y emitir el certificado.</p>
                </li>
            </ol>
            <p>—</p>
            <p><img src="https://lh7-rt.googleusercontent.com/docsz/AD_4nXfhYRQ8qLg4-EUZ3rT3C8pG4ITLAh_1tuheabH2ZxkK1nZs2ZjoDC-3w6FUG5vFJ2VYjxlAJtv73OpnvT5MYezGEXZkoLK2Ti1VfaLX55saTbFY_TjtOdY6bgN_YaOdkI5C2C1kXw?key=_YQlVURTdgHza7i-ocS-hCXB"
                    alt=""></p>
            <h4 id="-paso-6-configurar-reglas-de-firewall">Paso 6: Configurar Reglas de Firewall</h4>
            <ol>
                <li>
                    <p>Ir a <code>Firewall &gt; Rules &gt; WAN</code>.</p>
                </li>
                <li>
                    <p>Añadir una regla:</p>
                </li>
                <li>
                    <p><strong>Action:</strong> Pass</p>
                </li>
                <li>
                    <p><strong>Protocol:</strong> UDP</p>
                </li>
                <li>
                    <p><strong>Destination Port:</strong> 1194</p>
                </li>
                <li>
                    <p><strong>Description:</strong> Allow OpenVPN</p>
                </li>
            </ol>
            <ol>
                <li>
                    <p>Ir a <code>Firewall &gt; Rules &gt; OpenVPN</code>.</p>
                </li>
                <li>
                    <p>Añadir una regla:</p>
                </li>
                <li>
                    <p><strong>Action:</strong> Pass</p>
                </li>
                <li>
                    <p><strong>Source:</strong> any</p>
                </li>
                <li>
                    <p><strong>Destination:</strong> (<a href="http://192.168.1.0/24">192.168.1.0/24</a>)</p>
                </li>
                <li>
                    <p><strong>Description:</strong> Allow VPN Clients</p>
                </li>
            </ol>
            <hr>
            <p><img src="https://lh7-rt.googleusercontent.com/docsz/AD_4nXcADhhQHBNyZ6l8b1KizgrDDZSRRabUV3OY1GHHdOdFQsV9N_xqcAsaPlQTp0FDXmKjnWfBTMjp6ynrzfKfMdLyDDZqM0UnuXl4KTciAafCoVs11hMjGMAMDKK740fkalRcW35a4w?key=_YQlVURTdgHza7i-ocS-hCXB"
                    alt=""></p>
            <h4 id="-paso-7-exportar-la-configuraci-n-del-cliente">Paso 7: Exportar la Configuración del Cliente</h4>
            <ol>
                <li>
                    <p>Ir a <code>VPN &gt; OpenVPN &gt; Client Export</code>.</p>
                </li>
                <li>
                    <p>Seleccionar el usuario.</p>
                </li>
                <li>
                    <p>Descargar el instalador o archivo de configuración para su sistema operativo.</p>
                </li>
            </ol>
            <hr>
            <p><img src="https://lh7-rt.googleusercontent.com/docsz/AD_4nXeE2SOAivHJbI4tuArpHgmi0eyDf095Ola0vkVJVbX14JtbKPATBrbmIWbCqpNF6-0vyyTsdvP6jg2i42ZEfWMYap7MdLJTvPjCiik7lh2N4MROzw2WFqNSX301TDEpBxHrVNsW3g?key=_YQlVURTdgHza7i-ocS-hCXB"
                    alt=""></p>
            <h4 id="-paso-8-conectarse-desde-el-cliente">Paso 8: Conectarse desde el Cliente</h4>
            <ol>
                <li>
                    <p>Instalar OpenVPN Client en el dispositivo del usuario.</p>
                </li>
                <li>
                    <p>Importar el archivo <code>.ovpn</code> o usar el instalador.</p>
                </li>
                <li>
                    <p>Conectarse al servidor.</p>
                </li>
            </ol>


            <h3 id="5-hardware-compatible">5. Hardware Compatible</h3>
            <p>Para una implementación óptima de <strong>Proxmox VE</strong>, se recomienda el siguiente
                hardware:</p>
            <ul>
                <li><strong>Procesador</strong>: Intel 64 o AMD64 con soporte para virtualización (Intel
                    VT-x/AMD-V).
                </li>
                <li><strong>Memoria RAM</strong>: Mínimo <strong>2 GB</strong> para el sistema y servicios de
                    Proxmox
                    VE,
                    más RAM adicional según las máquinas virtuales. Para <strong>Ceph</strong> o
                    <strong>ZFS</strong>,
                    se
                    recomienda <strong>1 GB extra por cada TB de almacenamiento</strong>.
                </li>
                <li><strong>Almacenamiento</strong>: Se recomienda <strong>SSD</strong> para mejor rendimiento y
                    redundancia.</li>
                <li><strong>Almacenamiento del sistema operativo</strong>: RAID por hardware con
                    <strong>BBU</strong>
                    (Battery Backup Unit) o <strong>ZFS</strong> sin RAID.
                </li>
                <li><strong>Almacenamiento de máquinas virtuales</strong>: RAID por hardware con BBU o sin RAID
                    con
                    <strong>ZFS</strong>. Ni <strong>ZFS</strong> ni <strong>Ceph</strong> son compatibles con
                    controladores
                    RAID por hardware. También se puede usar almacenamiento compartido o distribuido.
                </li>
                <li><strong>Red</strong>: Interfaces de red <strong>Gigabit</strong> redundantes, con opción a
                    <strong>10
                        Gbit</strong> o superior según el clúster y la tecnología de almacenamiento.
                </li>
                <li><strong>Passthrough PCI(e)</strong>: Se requiere una CPU con soporte para
                    <strong>VT-d</strong> o
                    <strong>AMD-d</strong>.
                </li>
            </ul><br>

            <h3 id="6-webgrafía">6. Webgrafía</h3>
            <ol>
                <li><a
                        href="https://its.utu.edu.uy/wp-content/uploads/sites/33/2024/07/MANUAL-DE-USUARIO-DEL-SERVIDOR-PROXMOX.pdf">Manual
                        de Usuario del Servidor Proxmox</a></li>
                <li><a href="https://www.proxmox.com">Sitio Oficial de Proxmox</a></li>
                <li><a href="https://docs.netgate.com/pfsense/en/latest/">Documentación de PFSense</a></li>
                <li><a href="https://isnum.com/">Isnum</a></li>
            </ol>
    </div>
    <footer>
        <div class="separator"></div>
        <div class="footer-width-fixer"></div>
        <div class="footer-links">
            <a href="#">Términos y condiciones</a>
            <span class="divider">|</span>
            <a href="Html/politica_privacidad.html">Políticas de Privacidad</a>
            <span class="divider">|</span>
            <a href="#">Políticas de Cookies</a>
            <span class="divider">|</span>
            <a href="#">Aviso Legal</a>
        </div>
        <div class="footer-copyright">
            <p>Copyright © 2025 TECHSYS - Todos los derechos reservados</p>
        </div>
        </div>
    </footer>
</body>

</html>